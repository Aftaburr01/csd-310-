;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="e3ce43f5-beae-2e26-02db-d02d79590569")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,773240,429190,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(878420),i=e.i(569384),a=e.i(973245);e.i(304277);var o=e.i(566901);function s(){var e=(0,i._)(["\n  fragment FeaturedReplCardRepl on Repl {\n    id\n    title\n    description\n    iconUrl\n    timeUpdated\n    imageUrl\n    url\n    templateInfo {\n      imageUrl\n    }\n    publicForkCount\n  }\n"]);return s=function(){return e},e}var l=(0,a.gql)(s());function u(){var e=(0,i._)(["\n  fragment FeaturedReplPreviewRepl on Repl {\n    id\n    ...FeaturedReplCardRepl\n  }\n  ","\n"]);return u=function(){return e},e}function c(){var e=(0,i._)(["\n  query FeaturedReplPreviewReplInfo($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isFeaturedRepl\n      }\n    }\n  }\n"]);return c=function(){return e},e}var d={},p=(0,a.gql)(u(),l),f=(0,a.gql)(c());function h(e){var t=(0,r._)({},d,e);return o.useLazyQuery(f,t)}e.s(["FeaturedReplPreviewReplFragmentDoc",()=>p,"useFeaturedReplPreviewReplInfoLazyQuery",()=>h],429190);var m=e.i(140959),g=e.i(222342),v=e.i(220897),_=e.i(140487),x=e.i(960178),y=e.i(625484);e.s(["default",0,function(e){var r=e.isFeatured,i=e.repl,a=e.orgId,o=e.onCompleted,s=(0,g.default)(),l=s.showError,u=s.showConfirm,c=(0,t._)((0,m.useOrgFeaturedReplsUpdateMutation)({onError:function(){l("Something unexpected happened")},onCompleted:function(e){"Org"===e.updateOrgFeaturedRepl.__typename?(u("Profile updated successfully"),F()):l(e.updateOrgFeaturedRepl.message)}}),2),d=c[0],p=c[1].loading,f=(0,t._)((0,m.useOrgFeaturedReplsDeleteMutation)({onError:function(){l("Something unexpected happened")},onCompleted:function(e){"Org"===e.removeOrgFeaturedRepl.__typename?(u("Removed featured App"),F()):l(e.removeOrgFeaturedRepl.message)}}),2),R=f[0],w=f[1].loading,F=(0,t._)(h({variables:{replId:i.id},fetchPolicy:"network-only",ssr:!1}),1)[0];return a?(0,n.jsxs)(y.View,{justify:"center",gap:16,children:[(0,n.jsx)(x.Text,{variant:"headerDefault",children:r?"Remove from featured repls":"Feature App on your profile"}),(0,n.jsx)(x.Text,{variant:"text",children:r?"Do you want to remove this App from the Featured section?":"Display this App at the top of your organization's profile. Only public Apps can be featured."}),(0,n.jsx)(v.FeaturedReplCard,{repl:i,index:0,hideForkButton:!0}),(0,n.jsxs)(y.View,{row:!0,justify:"space-between",align:"center",children:[(0,n.jsx)(_.Button,{text:"Cancel",onClick:o}),(0,n.jsx)(_.Button,{colorway:"primary",text:r?"Remove":"Feature on profile",onClick:function(){r?R({variables:{input:{orgId:a,replId:i.id}}}):d({variables:{input:{orgId:a,replId:i.id}}}),o()},loading:p||w})]})]}):null}],773240)},957353,e=>{"use strict";var t=e.i(569384);function n(){var e=(0,t._)(["\n  fragment ReplListBoxItemRepl on Repl {\n    id\n    title\n    iconUrl\n    isFeaturedRepl\n    description(plainText: true)\n  }\n"]);return n=function(){return e},e}var r=(0,e.i(973245).gql)(n());e.s(["ReplListBoxItemReplFragmentDoc",()=>r])},140959,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(951262),a=e.i(304277);e.i(566901);var o=e.i(957353);function s(){var e=(0,n._)(["\n  fragment OrgFeaturedReplsSearchReplItem on Repl {\n    __typename\n    id\n    ...ReplListBoxItemRepl\n    org {\n      id\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function l(){var e=(0,n._)(["\n  fragment OrgFeaturedReplsSearchInputRepls on ReplConnection {\n    items {\n      ...OrgFeaturedReplsSearchReplItem\n    }\n    pageInfo {\n      hasNextPage\n      nextCursor\n    }\n  }\n  ","\n"]);return l=function(){return e},e}function u(){var e=(0,n._)(["\n  mutation OrgFeaturedReplsUpdate($input: UpdateOrgFeaturedReplInput!) {\n    updateOrgFeaturedRepl(input: $input) {\n      ... on Org {\n        id\n        __typename\n        featuredRepls {\n          __typename\n          ... on OrgFeaturedReplConnection {\n            items {\n              repl {\n                ...OrgFeaturedReplsSearchReplItem\n              }\n            }\n          }\n        }\n      }\n      ... on Error {\n        __typename\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function c(){var e=(0,n._)(["\n  mutation OrgFeaturedReplsDelete($input: RemoveOrgFeaturedReplInput!) {\n    removeOrgFeaturedRepl(input: $input) {\n      ... on Org {\n        id\n        __typename\n        featuredRepls {\n          __typename\n          ... on OrgFeaturedReplConnection {\n            items {\n              repl {\n                ...OrgFeaturedReplsSearchReplItem\n              }\n            }\n          }\n        }\n      }\n      ... on Error {\n        __typename\n        message\n      }\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function d(){var e=(0,n._)(["\n  query OrgFeaturedReplsSearchInputList(\n    $searchTerm: String!\n    $orgId: String!\n    $cursor: String\n  ) {\n    currentUser {\n      __typename\n      id\n      org(orgId: $orgId) {\n        __typename\n        ... on Org {\n          id\n          repls(\n            input: {\n              filters: { title: { search: $searchTerm }, visibility: public }\n              cursor: $cursor\n            }\n          ) {\n            __typename\n            ... on ReplConnection {\n              ...OrgFeaturedReplsSearchInputRepls\n            }\n            ... on UserError {\n              message\n            }\n          }\n        }\n        ... on NotFoundError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var p={},f=(0,r.gql)(s(),o.ReplListBoxItemReplFragmentDoc),h=(0,r.gql)(l(),f),m=(0,r.gql)(u(),f);function g(e){var n=(0,t._)({},p,e);return i.useMutation(m,n)}var v=(0,r.gql)(c(),f);function _(e){var n=(0,t._)({},p,e);return i.useMutation(v,n)}var x=(0,r.gql)(d(),h);function y(e){var n=(0,t._)({},p,e);return a.useQuery(x,n)}e.s(["useOrgFeaturedReplsDeleteMutation",()=>_,"useOrgFeaturedReplsSearchInputListQuery",()=>y,"useOrgFeaturedReplsUpdateMutation",()=>g])},220897,e=>{"use strict";var t=e.i(721281),n=e.i(276385),r=e.i(412160),i=e.i(46654),a=e.i(473497),o=e.i(967629),s=e.i(480028),l=e.i(446530),u=e.i(754873),c=e.i(613355),d=e.i(140487),p=e.i(929872),f=e.i(960178),h=e.i(625484),m=e.i(464092),g=e.i(418944),v=e.i(592877),_=function(e){var t,o,s=e.repl,l=e.hideForkButton,u=(0,m.useForkContext)(),c=s.title,_=s.description,y=s.iconUrl,F=s.timeUpdated,b=s.publicForkCount,I=s.url;return(0,n.jsxs)(p.Surface,{css:R.featureCardWrapper,tabIndex:-1,children:[(0,n.jsx)(h.View,{css:R.imageWrapper,children:(0,n.jsx)(a.default,{alt:s.title,imageUrl:null!=(o=s.imageUrl)?o:null==(t=s.templateInfo)?void 0:t.imageUrl,width:135,height:135,style:{borderRadius:"4px 0px 0px 4px"}})}),(0,n.jsxs)(h.View,{css:R.detailsColumn,grow:!0,shrink:!0,children:[(0,n.jsxs)(h.View,{grow:!0,pt:8,row:!0,align:"start",justify:"space-between",children:[(0,n.jsx)(r.default,{href:"".concat(I,"/view"),css:w.link,target:"_blank",children:(0,n.jsxs)(h.View,{css:R.titleWithIcon,grow:!0,shrink:!0,row:!0,gap:12,align:"center",children:[(0,n.jsx)(g.default,{surface:!0,alt:c,size:32,iconUrl:y}),(0,n.jsxs)(h.View,{css:x.titleTimeWrapper,children:[(0,n.jsx)(f.Text,{variant:"headerDefault",color:"default",multiline:!1,children:c}),(0,n.jsxs)(f.Text,{variant:"small",color:"dimmest",multiline:!1,children:["Updated ",(0,i.ago)(F)]})]})]})}),l?null:(0,n.jsxs)(h.View,{css:R.forkCount,pt:8,row:!0,gap:8,align:"center",children:[(0,n.jsx)(h.View,{children:b}),(0,n.jsx)(d.Button,{className:"forkButton",variant:"nofill",css:R.forkButton,text:u.isForking?"Remixing...":"Remix",isDisabled:u.isForking,onClick:function(){u.isForking||u.fork()},disabled:u.isForking,iconLeft:(0,n.jsx)(v.default,{})})]})]}),(0,n.jsx)(h.View,{grow:2,children:(0,n.jsx)(f.Text,{color:"dimmer",maxLines:2,children:_})})]})]})},x=(0,l.cssRecord)({titleTimeWrapper:[c.rcss.color.foregroundDefault,c.rcss.flex.column,c.rcss.flex.shrink(1),c.rcss.minWidth(0)]}),y=(0,o.css)({"::after":{borderRadius:s.tokens.space8,content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,display:"block",zIndex:1}}),R=(0,l.cssRecord)({featureCardWrapper:[c.rcss.position.relative,c.rcss.rowWithGap(16),c.rcss.height(135),c.rcss.overflow("hidden"),u.interactive.filledAndOutlined,c.rcss.pr(16),{width:"100%"}],detailsColumn:[{width:"100%"}],titleWithIcon:[c.rcss.minWidth(0),c.rcss.mr(8)],forkCount:[c.rcss.color.foregroundDimmer],forkButton:[c.rcss.zIndex(2),c.rcss.hover({backgroundColor:s.tokens.interactiveBackgroundActive})],imageWrapper:[c.rcss.width(135),(0,t._)({},c.media.max(550),[c.rcss.width(110)])]}),w=(0,l.cssRecord)({link:[y,c.rcss.focusRingOnAfter,c.rcss.flex.growAndShrink(1),c.rcss.minWidth(0)]});e.s(["FeaturedReplCard",()=>_,"default",0,function(e){var t=e.featuredRepls;return t?(0,n.jsxs)(h.View,{gap:8,children:[(0,n.jsx)(f.Text,{variant:"subheadBig",color:"default",children:"Featured Apps"}),(0,n.jsx)(h.View,{gap:16,children:t.items.map(function(e,t){return(0,n.jsx)(m.ForkContextProvider,{forkParams:{trackingData:{forkSource:"orgFeaturedRepl"}},repl:e.repl,children:(0,n.jsx)(_,{repl:e.repl,index:t})},e.repl.id)})})]}):null}])},714260,e=>{"use strict";var t=(0,e.i(389959).createContext)(null);e.s(["default",0,t])},376847,e=>{"use strict";var t=e.i(276385),n=e.i(399528),r=e.i(921521),i=e.i(441329),a=e.i(446530),o=e.i(613355),s=e.i(140487),l=e.i(739521),u=e.i(960178),c=e.i(625484),d=e.i(283110),p=e.i(121817),f=(0,a.cssRecord)({button:[o.rcss.flex.growAndShrink(1)],closeButton:[o.rcss.position.absolute,o.rcss.top(8),o.rcss.right(8),o.rcss.p(4),o.rcss.borderRadius(4),o.rcss.cursor.pointer,o.rcss.color.foregroundDimmer,{"&:hover":{backgroundColor:"var(--color-background-higher)"}}]});e.s(["default",0,function(e){var a=e.isOpen,o=e.text,h=e.disableHomeButton,m=e.onDismiss,g=(0,n.useRouter)(),v=(0,i.isInBonsaiWebview)(g),_=(0,r.default)();return(0,t.jsx)(l.Modal,{preventClose:!0,isOpen:a,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,t.jsxs)(c.View,{gap:16,style:{position:"relative"},children:[m?(0,t.jsx)(c.View,{css:f.closeButton,onClick:m,role:"button",tabIndex:0,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&m()},children:(0,t.jsx)(d.default,{size:16})}):null,(0,t.jsxs)(c.View,{row:!0,gap:16,align:"center",children:[(0,t.jsx)(p.default,{size:24}),(0,t.jsx)(u.Header,{css:{width:"fit-content"},level:2,variant:"headerDefault",children:"Please Refresh"})]}),(0,t.jsxs)(c.View,{pr:32,gap:16,children:[(0,t.jsx)(u.Text,{children:o||"Your connection to this App has been temporarily interrupted.\n            Usually this is because of a network issue."}),v?(0,t.jsx)(u.Text,{children:"If the issue continues please logout and re-login."}):null]}),(0,t.jsxs)(c.View,{row:!0,gap:16,children:[h||v||_?null:(0,t.jsx)(s.Button,{css:f.button,text:"Back to Home",onClick:function(){g.push("/home","~/")}}),(0,t.jsx)(s.Button,{text:"Refresh",colorway:"primary",css:f.button,onClick:function(){window.location.reload()}})]})]})})}])},399978,e=>{"use strict";var t,n=e.i(297083),r=e.i(346715),i=e.i(817556),a=e.i(826771),o=e.i(903381),s=((t={}).AlreadyExists="ALREADY_EXIST",t.FileRead="FILE_READ",t.Network="NETWORK",t);function l(e){return(0,n._)(function(e){var t,s,l,u,c,d,p,f,h,m,g,v;return(0,i._)(this,function(_){switch(_.label){case 0:if(t=e.parentPath,s=e.overwrite,l=e.fs,u=e.files,c=e.onStart,d=e.onUpload,p=e.onError,f=e.onDone,h=e.envMigrationFlag,u.length>1e6)throw Error("Trying to upload too many files at once.");if(u.reduce(function(e,t){return t.size+e},0)>0xc800000)throw Error("Total file upload size exceeds maximum limit.");return m=function(e){var t=e.targetPath,r=e.file,a=e.progress;return(0,n._)(function(){var e,n;return(0,i._)(this,function(i){switch(i.label){case 0:if(s)return[3,2];return[4,l.stat(t)];case 1:if(i.sent().exists)return p(e={file:r,path:t,error:"ALREADY_EXIST"}),[2,e];i.label=2;case 2:return[4,l.transferFile(t,r,function(e,t){a.current=t/e},h)];case 3:if(i.sent().error===o.FsErrors.NotReadable)return p(n={file:r,path:t,error:"FILE_READ"}),[2,n];return null==d||d({file:r,path:t}),[2,{path:t,file:r}]}})})()},g=u.map(function(e){var n=e.dirPath||e.webkitRelativePath||e.name;return{targetPath:t?t+"/"+n:n,progress:(0,a.observableValue)(0),file:e}}),null==c||c(g),[4,Promise.all(g.map(m))];case 1:return v=_.sent(),null==f||f({parentPath:t,uploads:v.filter(function(e){return!("error"in e)}),errors:v.reduce(function(e,t){return"error"in t?(0,r._)(e).concat([t]):e},[])}),[2]}})}).apply(this,arguments)}e.s(["MAX_FILE_UPLOAD_SIZE_LIMIT_BYTES",()=>0xc800000,"MAX_NUM_FILES_UPLOAD_LIMIT",()=>1e6,"UploadErrors",()=>s,"uploadFiles",()=>l])},123111,e=>{"use strict";var t=e.i(441329),n=/iPad|iPhone|iPod/,r=/MacIntel/;function i(){var e=(0,t.useIsInBonsaiWebview)(),i=!!n.test(navigator.platform)||!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&r.test(navigator.platform));return e||i}e.s(["default",()=>i])},284058,e=>{"use strict";var t=e.i(993796);function n(){return(0,t.useFlag)({controlName:"flag-plastic-makeup",type:"boolean",default:!1})}function r(){var e=n(),r=(0,t.useFlag)({controlName:"flag-upfront-build-mode",type:"boolean",default:!1});return!!e&&(r?"upfront":"pill")}e.s(["useDesignStackVariant",()=>r,"useIsDesignStackEnabled",()=>n])},445059,e=>{"use strict";var t=e.i(297083),n=e.i(878420),r=e.i(64386),i=e.i(530658),a=e.i(817556),o=e.i(389959),s=e.i(131141);e.i(242933);var l=e.i(279606);e.i(925218);var u=e.i(112077),c=e.i(399978),d=e.i(509908),p="attached_assets",f=function(e){return"".concat(p,"/").concat(e)};function h(e){var p=e.sessionId,h=e.uploadFiles,m=e.onError,g=(0,u.useCreateObservable)([]),v=(0,u.useCreateObservable)([]),_=(0,o.useMemo)(function(){return l.Observable.combine(l.Observable.from(g),l.Observable.from(v)).select(function(e){var t=(0,i._)(e,2),n=t[0],r=t[1];return n.some(function(e){return e.isLoading})||r.some(function(e){return e.file.isLoading})})},[g,v]),x=(0,o.useCallback)(function(e){g.update(function(t){return(0,s.produce)(t,function(t){var n=t.findIndex(function(t){return t.path===e});-1!==n&&t.splice(n,1)})})},[g]),y=(0,o.useCallback)(function(e){v.update(function(t){return(0,s.produce)(t,function(t){var n=t.findIndex(function(t){return t.file.path===e});-1!==n&&t.splice(n,1)})})},[v]),R=(0,o.useCallback)(function(e){return(0,t._)(function(){var t,i,o,l,u,v,_,y,R;return(0,a._)(this,function(a){switch(a.label){case 0:t=e.map(function(e){var t=function(e){if(e){var t=e.lastIndexOf("."),n=-1!==t?e.slice(0,t):e,r=-1!==t?e.slice(t):"";return"".concat(n,"_").concat(Date.now()).concat(r)}return"pasted_".concat(Date.now())}(e.fileName);return{path:f(t),mimeType:e.file.type,file:new File([e.file],t,{type:e.file.type,lastModified:e.file.lastModified}),isLoading:!0}}),i=!0,o=!1,l=void 0;try{for(u=t[Symbol.iterator]();!(i=(v=u.next()).done);i=!0){if((_=v.value).file.size>c.MAX_FILE_UPLOAD_SIZE_LIMIT_BYTES)return null==m||m("Attachment size exceeds ".concat(c.MAX_FILE_UPLOAD_SIZE_LIMIT_BYTES/1024/1024," MB limit.")),(0,d.trackAgentAnalyticsEvent)({action:"attempted_to_attach_file_exceeding_size_limit",fileType:_.file.type,fileSize:_.file.size,sessionId:p}),[2,[]];if("image/svg+xml"===_.file.type)return null==m||m("SVG images are not allowed"),(0,d.trackAgentAnalyticsEvent)({action:"attempted_to_attach_svg_image",sessionId:p}),[2,[]]}}catch(e){o=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw l}}return y=!1,[4,new Promise(function(e){g.update(function(e){return(0,s.produce)(e,function(e){var n=t.filter(function(t){return!e.some(function(e){return e.path===t.path})});if(e.length+n.length>20)return null==m||m("You can only attach up to ".concat(20," files.")),e;y=!0,t.forEach(function(t){var n=e.findIndex(function(e){return e.path===t.path});-1!==n?e[n]=t:e.push(t)})})}),e()})];case 1:if(a.sent(),!y)return[2,[]];if(t.forEach(function(e){(0,d.trackAgentAnalyticsEvent)({action:"attached_file",fileType:e.file.type,fileSize:e.file.size,sessionId:p})}),R=t.map(function(e){return e.file}),!h)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,h({files:R,onError:function(e){t.forEach(function(e){return x(e.path)}),null==m||m("Error writing files: "+e)}})];case 3:return a.sent(),[3,5];case 4:return a.sent(),[2,[]];case 5:return g.update(function(e){return(0,s.produce)(e,function(e){t.forEach(function(t){var i=e.findIndex(function(e){return e.path===t.path});-1!==i&&(e[i]=(0,r._)((0,n._)({},e[i]),{isLoading:!1}))})})}),[2,t]}})})()},[h,x,m,p,g]),w=(0,o.useCallback)(function(e){var i=e.url,o=e.file;return(0,t._)(function(){var e;return(0,a._)(this,function(t){switch(t.label){case 0:return e=!1,[4,new Promise(function(t){v.update(function(t){return(0,s.produce)(t,function(t){var n=t.findIndex(function(e){return e.url===i&&e.file.path===o.path});if(-1===n&&t.length+g.current.length>=20)return null==m||m("You can only attach up to ".concat(20," files.")),t;e=!0,-1!==n?t[n]={url:i,file:o}:t.push({url:i,file:o})})}),t()})];case 1:if(t.sent(),!e)return[2,null];if((0,d.trackAgentAnalyticsEvent)({action:"attached_url_file",fileType:o.file.type,fileSize:o.file.size,sessionId:p}),!h)return[3,5];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,h({files:[o.file],onError:function(e){y(o.path),null==m||m("Error writing URL file: "+e)}})];case 3:return t.sent(),v.update(function(e){return(0,s.produce)(e,function(e){var t=e.findIndex(function(e){return e.url===i});-1!==t&&(e[t].file=(0,r._)((0,n._)({},e[t].file),{isLoading:!1}))})}),[3,5];case 4:return t.sent(),[2,null];case 5:return[2,{url:i,file:o}]}})})()},[h,y,m,p,v,g]),F=(0,o.useCallback)(function(){g.set([]),v.set([])},[g,v]);return(0,o.useMemo)(function(){return{attachments:g,removeAttachment:x,removeUrlAttachment:y,clearAttachments:F,urlAttachments:v,addAttachments:R,addUrlAttachment:w,isLoading:_}},[g,x,y,F,v,R,w,_])}e.s(["ATTACHED_ASSETS_PATH",()=>p,"getAttachedAssetsPath",()=>f,"useAttachmentsImpl",()=>h],445059)},170784,122965,534518,e=>{"use strict";var t=e.i(878420),n=e.i(389959),r=e.i(992785);function i(e){var t=e.repl,n=e.currentUser;return{asViewer:e.asViewer,repl:{__typename:"Repl",authorizations:t.authorizations,id:t.id,language:t.language},currentUser:n?{__typename:"CurrentUser",id:n.id,username:n.username,isSubscribed:n.isSubscribed}:void 0}}function a(e){var a=e?i((0,t._)({},e)):null,o=(0,n.useRef)(a);return(0,r.default)(a,o.current)||(o.current=a),o.current}e.s(["createConnectContext",()=>i,"useMemoizedConnectContext",()=>a],170784);var o=e.i(775973),s=e.i(98816);function l(){var e=(0,o.useLDClient)(),t=(0,s.default)(e);return(0,n.useCallback)(function(){var e,n;return!Number.isFinite(n=parseInt(null==(e=t.current)?void 0:e.variation("flag-container-retry-minimum-ms",0),10))||n<0?0:n},[t])}e.s(["useFlaggedRetrier",()=>l],122965);var u=e.i(629712),c=e.i(858248),d=e.i(297083),p=e.i(530658),f=e.i(119468),h=e.i(817556),m=e.i(469546),g=e.i(282453),v={};function _(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.info("ot client dataloss",(0,t._)({case:n,startTime:r.startTime,opsSinceFlush:r.opsSinceFlush,whileReconnecting:r.whileReconnecting,replid:r.replId,filePath:r.filePath},i))}var x={replsList:function(){return"dataLossRepls"},replFiles:function(e){return"dataLossReplFiles".concat(e)},latestOp:function(e,t){return"dataLossLatestOp--".concat(e,"--").concat(t)},latestFlushedOp:function(e,t){return"dataLossLatestFlushed--".concat(e,"--").concat(t)},latestOwnOp:function(e,t){return"dataLosslatestOwnOp--".concat(e,"--").concat(t)},opsSinceFlush:function(e,t){return"dataLossOpsSinceFlush--".concat(e,"--").concat(t)}};function y(){var e=g.default.get(x.replsList(),"array");return e||(e=[],g.default.set(x.replsList(),e)),e}function R(e){var t=g.default.get(x.replFiles(e),"array");return t||(t=[],g.default.set(x.replFiles(e),t)),t}function w(e){var t=R(e),n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;"string"==typeof s&&function(e,t){g.default.remove(x.latestOp(e,t)),g.default.remove(x.latestFlushedOp(e,t)),g.default.remove(x.latestOwnOp(e,t));var n=R(e).filter(function(e){return e!==t});g.default.set(x.replFiles(e),n)}(e,s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}g.default.remove(x.replFiles(e));var l=y().filter(function(t){return t!==e});g.default.set(x.replsList(),l)}function F(e){var t,n=e.replId,r=e.filePath;(t=y()).includes(n)||(t.length>20?(w(t[0]),t[0]=n):t.push(n),g.default.set(x.replsList(),t));var i=R(n);i.includes(r)||(i.length>20?(w(i[0]),i[0]=r):i.push(r),g.default.set(x.replFiles(n),i))}function b(e){var t=e.filePath,n=e.replId,r=e.opType,i=e.op;!function(e){var t=e.filePath,n=e.replId,r=e.opType,i=e.logger,a=e.isReconnecting,o=_.bind(null,i),s="".concat(n,"--").concat(t);v[s]||(v[s]={replId:n,filePath:t,timer:null,startTime:null,whileReconnecting:0,opsSinceFlush:0});var l=v[s];if("latestFlushedOp"===r){delete v[s];var u=l.startTime;if(u){var c=Date.now()-u;c>6e4&&o("flush_delay_received",l,{elapsed:c})}var d=l.timer;d&&(clearTimeout(d),l.timer=null)}else{l.opsSinceFlush+=1,a&&(l.whileReconnecting+=1);var p,f=null!=(p=l.startTime)?p:Date.now();l.startTime=f,l.timer||(l.timer=setTimeout(function(){o("flush_delay_timeout",l)},6e4)),150===l.opsSinceFlush?o("flush_delay_small",l):1e3===l.opsSinceFlush&&o("flush_delay_large",l)}}({filePath:t,replId:n,opType:r,logger:e.logger,isReconnecting:e.isReconnecting}),g.default.set(x[r](n,t),i)}var I={};function k(e){return(0,d._)(function(e){var t,n,r,i,a,o,s,l;return(0,h._)(this,function(u){return t=e.filePath,n=e.replId,r=e.serverVersion,i=e.serverContent,a=e.fetchOps,o=e.logger,I[t+n]||(I[t+n]=!0,s=function(e,t){var n={latestOp:null,latestFlushedOp:null,latestOwnOp:null},r=Object.keys(n),i=!0,a=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=g.default.get(x[u](e,t),"object");c&&c&&(void 0===c?"undefined":(0,f._)(c))==="object"&&"number"==typeof c.crc32&&"number"==typeof c.version&&(n[u]=c)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return n}(n,t),l=m.str(i)>>>0,Object.keys(s).forEach(function(e){return(0,d._)(function(){var t,n,i;return(0,h._)(this,function(u){switch(u.label){case 0:if(!(t=s[e]))return[2];if(r<t.version)return o.info("ot client dataloss",{opType:e,case:"server_forgot"}),[2];if(r===t.version)return l!==t.crc32&&o.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,a(t.version,t.version)];case 2:return n=p._.apply(void 0,[u.sent(),1])[0],[3,4];case 3:return i=u.sent(),o.info("ot client dataloss",{opType:e,case:"error_fetching_op",originalError:String(i)}),[2];case 4:if(!n)return o.info("ot client dataloss",{opType:e,case:"op_not_found"}),[2];return n.crc32!==t.crc32&&o.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2]}})})()})),[2]})}).apply(this,arguments)}e.s(["checkAndTrack",()=>k,"ensureTrackedFile",()=>F,"storeOp",()=>b],518656);var O=e.i(518656);function T(e){var t=e.container;return(0,u.default)({container:t,dataloss:O,track:c.track})}e.s(["default",()=>T],534518)},377772,e=>{"use strict";var t=e.i(906368);function n(e,n){return t.withScope(function(r){r.setTag("start-with-ai",!0),n&&r.setExtras(n),t.captureException(e)}),e}e.s(["sendErrorToSentry",()=>n])},170710,e=>{"use strict";var t=e.i(276385),n=e.i(864558),r=e.i(389959),i=e.i(904851),a=e.i(90659),o=e.i(721281);e.i(242933);var s=e.i(790164),l=function(){function e(){var t=this;(0,i._)(this,e),(0,o._)(this,"state",new s.ObservableState(null)),(0,o._)(this,"timeoutId",null),(0,o._)(this,"start",function(e){t.clearTimeout(),t.state.set({prompt:e}),t.timeoutId=setTimeout(t.remove,2e4)}),(0,o._)(this,"update",function(e){var n,r=null==(n=t.state.current)?void 0:n.prompt;r&&t.state.set({prompt:r,repl:e})}),(0,o._)(this,"remove",function(){t.clearTimeout(),t.state.set(null)})}return(0,a._)(e,[{key:"clearTimeout",value:function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}}]),e}(),u=(0,r.createContext)(null),c=(0,n.default)(function(){return e.A(556827)},{loadableGenerated:{modules:[148805]},ssr:!1});function d(e){var n=(0,r.useRef)();return n.current||(n.current=new l),(0,t.jsxs)(u.Provider,{value:n.current,children:[e.children,(0,t.jsx)(c,{state:n.current.state})]})}function p(){return(0,r.useContext)(u)}e.s(["WorkspaceLoadingProvider",()=>d,"useWorkspaceLoadingState",()=>p],170710)}]);

//# debugId=e3ce43f5-beae-2e26-02db-d02d79590569
//# sourceMappingURL=90fa3eb1502a3daf.js.map